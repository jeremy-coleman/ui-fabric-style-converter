import autoExternal from 'rollup-plugin-auto-external'
import typescript from 'rollup-plugin-typescript2'

import {terser} from 'rollup-plugin-terser'

var pkgJson = require('./package.json')
var devDeps = Object.keys(pkgJson.devDependencies || {})
var peerDeps = Object.keys(pkgJson.peerDependencies || {})
var pkgDeps = Object.keys(pkgJson.dependencies || {})

devDeps.concat(peerDeps).concat(pkgDeps)

export default {
    external: [devDeps],
    input: 'src/index.ts',
	output: [
		{file: `lib-min/index.js`, format: "es", sourcemap: false},
		{file: `lib-min/index.mjs`, format: "es", sourcemap: false},
		{file: `lib-min/index.cjs.js`, format: "cjs", sourcemap: false},
	],
	plugins: [
        typescript({
            typescript: require('typescript')
        }),
        autoExternal(),
		terser()
	],
}
